machine:
  services:
    - docker

dependencies:
  pre:
    - curl -L https://github.com/docker/machine/releases/download/v0.8.0/docker-machine-`uname -s`-`uname -m` > ~/bin/docker-machine
    - chmod +x ~/bin/docker-machine

  cache_directories:
    - ~/docker
    - ~/bin

deployment:
  hub:
    branch: features/docker
    commands:
      - eval `aws ecr get-login`
      - docker-machine --storage-path docker/machine ls
      - eval $(docker-machine --storage-path docker/machine env app.production)
      - docker-compose up -d

test:
  override:
    - echo 'Skip'
